<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Student Portfolio ‚Äî Full Screen</title>
  <style>
    /* ---------- Base ---------- */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:#f3f4f6;
      color:#111827;
      overflow-x:hidden;
      -webkit-font-smoothing:antialiased;
    }

    /* ---------- Top nav ---------- */
    header.top-nav{
      width:100%;
      background:#ffffff;
      border-bottom:1px solid #e5e7eb;
      padding:0.85rem 2rem;
      display:flex;
      align-items:center;
      gap:1rem;
      position:sticky;
      top:0;
      z-index:40;
    }
    .logo{
      display:flex;align-items:center;gap:0.6rem;font-weight:700;
      background:linear-gradient(135deg,#0a66c2,#10b981);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
      font-size:1.05rem;
    }
    .nav-right{margin-left:auto;display:flex;gap:0.6rem;align-items:center}
    .nav-chip{padding:0.28rem 0.7rem;border-radius:999px;border:1px solid #e5e7eb;background:#f9fafb;font-size:0.8rem;color:#6b7280}

    /* ---------- Page grid ---------- */
    .page{
      display:grid;
      grid-template-columns:320px 1fr 360px;
      gap:24px;
      padding:24px 28px;
      align-items:start;
      width:100%;
      min-height:calc(100vh - 74px);
    }

    @media (max-width:1200px){
      .page{grid-template-columns:300px 1fr; padding:18px}
      .right-col{display:none}
    }
    @media (max-width:860px){
      .page{grid-template-columns:1fr;padding:14px}
    }

    .card{
      background:#ffffff;border:1px solid #e5e7eb;border-radius:14px;
      padding:18px;box-shadow:0 10px 30px rgba(15,23,42,0.04);
    }

    /* ---------- Left column ---------- */
    .profile-center{text-align:center}
    .avatar{
      width:96px;height:96px;border-radius:999px;margin:0 auto 10px;
      background:linear-gradient(135deg,#10b981,#059669);display:flex;align-items:center;justify-content:center;
      color:#fff;font-weight:700;font-size:28px;border:4px solid #e5e7eb;
    }
    .name{font-size:1.35rem;font-weight:700;margin-bottom:4px}
    .subtitle{color:#6b7280;font-size:0.9rem;margin-bottom:8px}
    .bio{color:#6b7280;font-size:0.86rem;line-height:1.4;margin-bottom:10px}

    .chip-row{display:flex;flex-wrap:wrap;gap:6px;justify-content:center;margin-top:8px}
    .chip{background:#f9fafb;border:1px solid #e5e7eb;padding:6px 10px;border-radius:999px;font-size:0.78rem;color:#374151}

    .section-title{font-weight:700;color:#111827;margin-top:16px;margin-bottom:8px;font-size:0.92rem}
    .info-table{background:#f9fafb;border:1px solid #e5e7eb;border-radius:10px;padding:8px;font-size:0.88rem}
    .info-row{display:flex;justify-content:space-between;padding:8px 6px;border-bottom:1px solid #e5e7eb}
    .info-row:last-child{border-bottom:none}
    .label-small{color:#6b7280}
    .value-strong{font-weight:700}

    .badges{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .badge{background:linear-gradient(135deg,#1d4ed8,#1e3a8a);color:#fff;padding:6px 10px;border-radius:999px;font-size:0.78rem}

    /* ---------- Middle column ---------- */
    .main{display:flex;flex-direction:column;gap:16px;}
    .overview{display:flex;flex-direction:column;gap:12px;}
    .pill{
      display:inline-flex;align-items:center;gap:10px;padding:10px 14px;border-radius:999px;background:#ecfdf5;border:1px solid #bbf7d0;color:#065f46;font-weight:600;font-size:0.93rem;width:100%;
    }

    .stats-row{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:6px}
    .stat-box{background:#f9fafb;border:1px solid #e5e7eb;border-radius:10px;padding:12px;font-size:0.88rem}
    .stat-label{color:#6b7280;font-size:0.82rem;margin-bottom:6px}
    .stat-value{font-weight:800;font-size:1.12rem;background:linear-gradient(135deg,#0a66c2,#10b981);-webkit-background-clip:text;-webkit-text-fill-color:transparent}

    .panel-head{display:flex;justify-content:space-between;align-items:center;margin-top:6px}
    .panel-title{font-weight:700;display:flex;align-items:center;gap:8px}
    .grid-breakdown{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:10px}
    .area-card{background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:12px;display:flex;flex-direction:column;justify-content:center;align-items:flex-start}
    .area-name{font-weight:700;margin-bottom:6px;font-size:0.95rem}
    .area-count{font-weight:800;font-size:1.1rem;color:#0a66c2}

    .case-list{display:flex;flex-direction:column;gap:12px;margin-top:12px}
    .case-card{background:#f9fafb;border:1px solid #e5e7eb;border-radius:12px;padding:14px;font-size:0.98rem;transition:all .18s ease}
    .case-card:hover{background:#ffffff;border-color:#0a66c2;transform:translateY(-4px)}
    .case-title{font-weight:800;font-size:1.02rem;margin-bottom:6px}
    .case-meta{color:#6b7280;font-size:0.86rem;margin-bottom:8px}
    .case-outcome{color:#374151;font-size:0.94rem;margin-bottom:10px}
    .read-more{color:#0a66c2;font-weight:700;text-decoration:none;font-size:0.88rem;display:inline-flex;gap:8px;align-items:center}

    .reviews{display:flex;flex-direction:column;gap:10px;margin-top:8px}
    .review{background:#f9fafb;border:1px solid #e5e7eb;border-radius:10px;padding:10px}
    .review-text{font-size:0.92rem;color:#111827;margin-bottom:8px}
    .review-meta{font-size:0.82rem;color:#6b7280}
    .stars{color:#f59e0b;font-size:1rem;margin-right:6px}

    /* ---------- Right column ---------- */
    .right-card .small-row{display:flex;justify-content:space-between;gap:8px;padding:8px 0;border-bottom:1px solid #e5e7eb}
    .right-card .small-row:last-child{border-bottom:none}
    .download-btn{display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border-radius:10px;background:linear-gradient(90deg,#0a66c2,#10b981);color:#fff;font-weight:700;text-decoration:none;margin-top:12px; width: 100%; justify-content: center;}

    /* Recruiter Feedback Styles */
    .recruiter-feedback {margin-top: 24px; border-top: 1px solid #e5e7eb; padding-top: 16px;}
    .recruiter-feedback label {display: block; font-size: 0.85rem; font-weight: 600; color: #374151; margin-bottom: 6px;}
    .recruiter-feedback textarea {width: 100%; border: 1px solid #d1d5db; border-radius: 8px; padding: 10px; font-family: inherit; font-size: 0.9rem; min-height: 80px; resize: vertical; margin-bottom: 12px;}
    .recruiter-feedback select {width: 100%; border: 1px solid #d1d5db; border-radius: 8px; padding: 8px; font-family: inherit; font-size: 0.9rem; margin-bottom: 12px; background-color: #fff;}
    .submit-review-btn {background: #111827; color: #fff; width: 100%; padding: 10px; border-radius: 10px; border: none; font-weight: 600; cursor: pointer; transition: background 0.2s;}
    .submit-review-btn:hover {background: #000;}

    @media (max-width:1200px){
      .stats-row{grid-template-columns:repeat(3,1fr)}
    }
    @media (max-width:860px){
      .stats-row{grid-template-columns:repeat(2,1fr)}
      .grid-breakdown{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <header class="top-nav">
    <div class="logo">‚öñÔ∏è LegalAid</div>
    <div class="nav-right">
      <div class="nav-chip">Student Portfolio</div>
    </div>
  </header>

  <div class="page">
    <aside class="card">
      <div class="profile-center">
        <div class="avatar" id="student-avatar">SR</div>
        <div class="name" id="student-name">Loading‚Ä¶</div>
        <div class="subtitle" id="student-subtitle"></div>
        <p class="bio" id="student-bio"></p>

        <div class="chip-row" id="student-chips"></div>
      </div>

      <div class="section-title">Profile Snapshot</div>
      <div class="info-table">
        <div class="info-row"><div class="label-small">Justice Rating</div><div class="value-strong" id="info-rating">‚Äî</div></div>
        <div class="info-row"><div class="label-small">Accuracy Rate</div><div class="value-strong" id="info-accuracy">‚Äî</div></div>
        <div class="info-row"><div class="label-small">Cases Solved</div><div class="value-strong" id="info-solved">‚Äî</div></div>
        <div class="info-row"><div class="label-small">Top Field</div><div class="value-strong" id="info-top-field">‚Äî</div></div>
      </div>

      <div class="section-title">Integrity & Exams</div>
      <div class="info-table">
        <div class="info-row"><div class="label-small">Proctor Integrity</div><div class="value-strong" id="info-integrity">‚Äî</div></div>
        <div class="info-row"><div class="label-small">Exam Sessions</div><div class="value-strong" id="info-exams">‚Äî</div></div>
      </div>

      <div class="section-title">Badges</div>
      <div class="badges" id="student-badges"></div>
    </aside>

    <main class="main">
      <div class="card overview">
        <div class="panel-head">
          <div class="panel-title">üìä Portfolio Overview</div>
          <div class="panel-sub" id="summary-line">Loading‚Ä¶</div>
        </div>

        <div class="pill" id="summary-pill">Loading‚Ä¶</div>

        <div class="stats-row" style="margin-top:10px">
          <div class="stat-box">
            <div class="stat-label">Justice Rating</div>
            <div class="stat-value" id="stat-rating">‚Äî</div>
            <div style="font-size:0.78rem;color:#9ca3af;margin-top:6px">Peer-weighted score</div>
          </div>
          <div class="stat-box">
            <div class="stat-label">Accuracy Rate</div>
            <div class="stat-value" id="stat-accuracy">‚Äî</div>
            <div style="font-size:0.78rem;color:#9ca3af;margin-top:6px">Solved vs attempted</div>
          </div>
          <div class="stat-box">
            <div class="stat-label">Avg. Time</div>
            <div class="stat-value" id="stat-time">‚Äî</div>
            <div style="font-size:0.78rem;color:#9ca3af;margin-top:6px">Claim ‚Üí final draft</div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="panel-head">
          <div class="panel-title">‚≠ê Case Breakdown</div>
          <div class="panel-sub" id="fields-count">Fields covered: ‚Äî</div>
        </div>
        <div class="grid-breakdown" id="case-breakdown"></div>
      </div>

      <div class="card">
        <div class="panel-head">
          <div class="panel-title">‚≠ê Recent Cases</div>
          <div class="panel-sub">Click "Read more" to open the case</div>
        </div>
        <div class="case-list" id="recent-cases"></div>
      </div>

      <div class="card">
        <div class="panel-head">
          <div class="panel-title">‚≠ê Reviews</div>
          <div class="panel-sub" id="avg-review">Average: ‚Äî / 10</div>
        </div>
        <div class="reviews" id="reviews"></div>
      </div>
    </main>

    <aside class="card right-col right-card">
      <div style="font-weight:700;margin-bottom:8px">Quick Summary</div>
      <div class="small-row"><div class="label-small">Solved</div><div class="value-strong" id="rs-solved">‚Äî</div></div>
      <div class="small-row"><div class="label-small">Accuracy</div><div class="value-strong" id="rs-accuracy">‚Äî</div></div>
      <div class="small-row"><div class="label-small">Integrity</div><div class="value-strong" id="rs-integrity">‚Äî</div></div>

      <a class="download-btn" href="#" onclick="alert('Mock: download portfolio')">Download Portfolio</a>
      <div style="margin-top:14px;font-size:0.85rem;color:#6b7280">Recruiter note: this page presents verified case outcomes, proctor integrity and peer reviews ‚Äî useful for hiring decisions.</div>

      <div class="recruiter-feedback">
        <div style="font-weight:700; margin-bottom: 12px; color: #111827;">Interview Feedback (Recruiter Only)</div>
        <label for="recruiter-notes">Interview Notes</label>
        <textarea id="recruiter-notes" placeholder="Enter notes from the interview session..."></textarea>
        
        <label for="hiring-decision">Recommendation</label>
        <select id="hiring-decision">
          <option value="" disabled selected>Select Decision</option>
          <option value="Hire">Strong Hire</option>
          <option value="Hold">Hold / Waitlist</option>
          <option value="Reject">Reject</option>
        </select>

        <button class="submit-review-btn" onclick="submitInterviewReview()">Submit Review</button>
      </div>
    </aside>
  </div>

  <script>
    async function loadStudentProfile() {
      const params = new URLSearchParams(window.location.search);
      const studentId = params.get("id");

      try {
        const res = await fetch("../students.json");
        const data = await res.json();
        const students = data.students || [];
        if (!students.length) throw new Error("No students in JSON");

        let s = students.find(st => st.id === studentId);
        if (!s) {
          console.warn("Student not found, falling back to first.");
          s = students[0];
        }

        // Basic identity
        document.getElementById("student-avatar").textContent = s.initials || (s.name ? s.name.split(" ").map(p=>p[0]).join("").slice(0,2) : "?");
        document.getElementById("student-name").textContent = s.name || "Unknown Student";
        document.getElementById("student-subtitle").textContent = (s.year || "") + (s.school ? " ‚Ä¢ " + s.school : "");
        document.getElementById("student-bio").textContent = s.headline || "";

        // Chips
        const chipsEl = document.getElementById("student-chips");
        chipsEl.innerHTML = "";
        (s.specializations || []).forEach(sp => {
          const div = document.createElement("div");
          div.className = "chip";
          div.textContent = sp;
          chipsEl.appendChild(div);
        });

        // Badges
        const badgesEl = document.getElementById("student-badges");
        badgesEl.innerHTML = "";
        (s.badges || []).forEach(b => {
          const div = document.createElement("div");
          div.className = "badge";
          div.textContent = b;
          badgesEl.appendChild(div);
        });

        const solved = s.solvedCases ?? s.casesCount ?? 0;
        const attempts = s.totalAttempts || solved || 1;
        const accuracy = Math.round((solved / attempts) * 100);

        // Snapshot
        document.getElementById("info-rating").textContent = s.justiceRating != null ? s.justiceRating : "‚Äî";
        document.getElementById("info-accuracy").textContent = accuracy + "%";
        document.getElementById("info-solved").textContent = solved;
        const areas = s.areas || {};
        const areaNames = Object.keys(areas);
        let topField = "‚Äî", topCount = -1;
        areaNames.forEach(a => { if (areas[a] > topCount) { topCount = areas[a]; topField = a; } });
        document.getElementById("info-top-field").textContent = topField;

        document.getElementById("info-integrity").textContent = (s.integrityScore != null ? s.integrityScore + "%" : "‚Äî");
        document.getElementById("info-exams").textContent = s.examSessions != null ? s.examSessions : "‚Äî";

        // Overview summary
        const summaryText = `Solved ${solved} of ${attempts} cases (${accuracy}% accuracy), strongest in ${(topField || "their main field").toLowerCase()}.`;
        document.getElementById("summary-line").textContent = summaryText;
        document.getElementById("summary-pill").textContent = summaryText;

        document.getElementById("stat-rating").textContent = (s.rating != null ? s.rating.toFixed(1) : "‚Äî");
        document.getElementById("stat-accuracy").textContent = accuracy + "%";
        document.getElementById("stat-time").textContent = (s.avgTimeHours != null ? s.avgTimeHours.toFixed(1) + " hrs" : "‚Äî");
        document.getElementById("fields-count").textContent = "Fields covered: " + areaNames.length;

        // Right summary
        document.getElementById("rs-solved").textContent = solved;
        document.getElementById("rs-accuracy").textContent = accuracy + "%";
        document.getElementById("rs-integrity").textContent = (s.integrityScore != null ? s.integrityScore + "%" : "‚Äî");

        // Case breakdown
        const breakdownEl = document.getElementById("case-breakdown");
        breakdownEl.innerHTML = areaNames.map(area => {
          const count = areas[area];
          return `
            <div class="area-card">
              <div class="area-name">${area}</div>
              <div class="area-count">${count} case(s)</div>
            </div>
          `;
        }).join("");

        // Recent cases
        const recentEl = document.getElementById("recent-cases");
        const recent = s.recentCases || [];
        if (!recent.length) {
          recentEl.innerHTML = `<div style="font-size:0.9rem;color:#6b7280;">No recent cases listed yet.</div>`;
        } else {
          recentEl.innerHTML = recent.map(c => `
            <div class="case-card">
              <div class="case-title">${c.icon || "üìÇ"} ${c.title}</div>
              <div class="case-meta">${c.area || ""}${c.duration ? " ‚Ä¢ " + c.duration : ""}</div>
              <div class="case-outcome">${c.outcome || ""}</div>
              ${c.link ? `<a class="read-more" href="${c.link}" target="_blank" rel="noopener">Read more ‚Üí</a>` : ""}
            </div>
          `).join("");
        }

        // Reviews
        const reviewsEl = document.getElementById("reviews");
        const reviews = s.reviews || [];
        if (!reviews.length) {
          document.getElementById("avg-review").textContent = "Average: ‚Äî / 10";
          reviewsEl.innerHTML = `<div style="font-size:0.9rem;color:#6b7280;">No reviews recorded yet.</div>`;
        } else {
          const avgReview = (reviews.reduce((sum,r)=>sum + r.score,0) / reviews.length).toFixed(1);
          document.getElementById("avg-review").textContent = "Average: " + avgReview + " / 10";
          reviewsEl.innerHTML = reviews.map(r => {
            const starCount = Math.round((r.score / 10) * 5);
            const stars = "‚òÖ".repeat(starCount) + "‚òÜ".repeat(5 - starCount);
            return `
              <div class="review">
                <div class="review-text"><span class="stars">${stars}</span> ${r.text}</div>
                <div class="review-meta">${r.by} ‚Ä¢ Score ${r.score.toFixed(1)}/10</div>
              </div>
            `;
          }).join("");
        }
      } catch (err) {
        console.error("Failed to load student profile", err);
        document.getElementById("student-name").textContent = "Student not found";
        document.getElementById("summary-line").textContent = "Could not load portfolio data.";
        document.getElementById("summary-pill").textContent = "Error loading data.";
      }
    }

    // Function to handle recruiter review submission
    function submitInterviewReview() {
      const notes = document.getElementById("recruiter-notes").value;
      const decision = document.getElementById("hiring-decision").value;

      if (!notes || !decision) {
        alert("Please fill in both the notes and select a decision.");
        return;
      }

      // In a real app, this data would be sent to a backend
      console.log("Recruiter Review Submitted:", {
        notes: notes,
        decision: decision,
        timestamp: new Date().toISOString()
      });

      // UI Feedback
      alert("Review submitted successfully!");
      
      // Optional: Disable fields to prevent duplicate submission
      document.getElementById("recruiter-notes").disabled = true;
      document.getElementById("hiring-decision").disabled = true;
      document.querySelector(".submit-review-btn").textContent = "Review Submitted";
      document.querySelector(".submit-review-btn").disabled = true;
      document.querySelector(".submit-review-btn").style.backgroundColor = "#10b981"; // Green color
    }

    window.addEventListener("DOMContentLoaded", loadStudentProfile);
  </script>
</body>
</html>